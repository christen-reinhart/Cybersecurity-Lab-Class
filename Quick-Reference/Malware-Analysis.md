# üß¨ Malware Analysis & Reverse Engineering Cheat Sheet

**Author**: Lenny Zeltser  
**Version**: 2.2  
**Course**: SANS FOR610 ‚Äì Reverse-Engineering Malware  
**License**: Creative Commons v3 ‚ÄúAttribution‚Äù

---

## üß≠ Malware Analysis Process Overview

1. Use sandbox tools for initial assessment.
2. Set up a controlled, isolated analysis lab.
3. Examine static properties & metadata.
4. Emulate code execution to assess capabilities.
5. Perform behavioral analysis (ProcMon, Wireshark, etc.).
6. Use disassembler/decompiler for static code analysis.
7. Perform dynamic code analysis (debuggers, breakpoints).
8. Unpack the specimen if needed.
9. Iterate as necessary to meet analysis objectives.
10. Augment with memory forensics, threat intel.
11. Document results, save artifacts, clean lab.

---

## üî¨ Behavioral Analysis

- Use VM snapshots or Clonezilla/dd/FOG/PXE for system reversion.
- Monitor local behavior with:
  - Process Explorer
  - Process Monitor
  - ProcDOT
  - Noriben
- Detect local changes with:
  - RegShot
  - Autoruns
- Monitor network behavior with:
  - Wireshark
  - Fiddler
- Redirect traffic: `fakedns`, `accept-all-ips`
- Simulate services: INetSim or real services
- Reinfect if needed, adjusting runtime as necessary

---

## üõ†Ô∏è Ghidra Hotkeys (Static Code Analysis)

| Action | Shortcut |
|--------|----------|
| Go to address | `g` |
| Show refs to instruction | `Ctrl+Shift+f` |
| Insert comment | `;` |
| Follow jump/call | `Enter` |
| Back / Forward | `Alt+Left` / `Alt+Right` |
| Undo | `Ctrl+z` |
| Define data type | `t` |
| Bookmark | `Ctrl+d` |
| Text search | `Ctrl+Shift+e` |
| Label edit | `l` |
| Disassemble | `d` |

---

## üêû x64dbg/x32dbg Hotkeys (Dynamic Analysis)

| Action | Shortcut |
|--------|----------|
| Run code | `F9` |
| Step into/over | `F7` / `F8` |
| Run to selection | `F4` |
| Return to caller | `Ctrl+F9` |
| Prev/Next executed | `-` / `+` |
| Back to previous view | `*` |
| Goto expression | `Ctrl+g` |
| Add comment/label | `;` / `:` |
| Graph view | `g` |
| Pattern search | `Ctrl+b` |
| Breakpoint on instruction | Select ¬ª `F2` |
| Breakpoint on API | `SetBPX <API>` |
| Highlight keywords | `h` + click |
| Patch instruction | `Spacebar` |
| Edit memory | `Ctrl+e` |
| Extract API calls | Right-click ¬ª Search ¬ª Intermodular calls |

---

## üß≥ Unpacking Malicious Code

- Detect packing: Detect It Easy, Exeinfo PE, Bytehist, peframe
- Quick dump: infect lab, dump memory with Scylla
- Precise unpack: find OEP in debugger, dump with OllyDumpEx
- Set breakpoints: stack/memory at start, API like LoadLibrary/VirtualAlloc
- Process injection: break on VirtualAllocEx, WriteProcessMemory
- If not dumpable: trace live behavior
- Rebuild imports: Scylla, Imports Fixer, pe_unmapper

---

## üîê Bypassing Analysis Defenses

- De-obfuscate: FLOSS, xorsearch, Balbuzard
- Decode in debugger: breakpoint post-decryption
- Hide debugger: ScyllaHide
- Patch anti-analysis routines
- Watch tricky jump logic (TLS, SEH, RET, CALL)
- Analyze shellcode: scdbg, runsc
- Disable ASLR: setdllcharacteristics, CFF Explorer

---

## üîó References

- [FOR610 Course](https://www.sans.org/cyber-security-courses/reverse-engineering-malware-malware-analysis-tools-techniques/)
- [Automated Malware Analysis](https://zeltser.com/automated-malware-analysis/)
- [Build Malware Analysis Toolkit](https://zeltser.com/build-malware-analysis-toolkit/)
- [Malware Analysis Report](https://zeltser.com/malware-analysis-report/)
- [FLOSS](https://github.com/mandiant/flare-floss)
- [x64dbg](https://x64dbg.com/)
- [ScyllaHide](https://github.com/x64dbg/ScyllaHide)
- [CFF Explorer](http://www.ntcore.com/exsuite.php)
- More cheat sheets: [https://zeltser.com/cheat-sheets/](https://zeltser.com/cheat-sheets/)

---

**Maintained by: Christen Reinhart**  
**Original Author: Lenny Zeltser (@lennyzeltser)**  
**Converted for GitHub Markdown format**
